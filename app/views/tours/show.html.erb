<%provide :title, "#{@tour.tour_title}"%>
<section class="breadcrumbs-custom-inset">
  <div class="breadcrumbs-custom context-dark bg-overlay-60">
    <div class="container">
      <h2 class="breadcrumbs-custom-title"><%= @tour.tour_title.html_safe %></h2>
      <ul class="breadcrumbs-custom-path">
        <li><a href="/">Home</a></li>
        <li class="active">Our Tours</li>
      </ul>
    </div>
    <div class="box-position" style="background-image: url(<%= rails_blob_url(@tour.medias[0])%>);"></div>
  </div>
</section>
<!----------------------------------->
<section id="blog" class=" mt-5">
  <div class="container" data-aos="fade-up">
    <div class="row">
      <div class="col-lg-8 entries">
        <%# <% @post do |n|%>
          <article class="entry">
            <a href="#" class="unit-1 text-center">
              <% if @tour.medias.attached? %>
                <div id="carouselExampleControls" class="carousel slide carousel-fade" data-ride="carousel" style="height:400px; " data-interval="1500">
                  <div class="carousel-inner">
                    <div class="carousel-item active">
                      <%= image_tag @tour.medias[0], :class => "img-fluid", style:"height:400px;" %>
                    </div>
                    <% @tour.medias.drop(1).each do |illustration| %>
                      <div class="carousel-item">
                        <%= image_tag(illustration, :class => "img-fluid", style:"height:400px;") %>
                      </div>
                    <%end%>
                  </div>
                </div>
              <%end%>
            </a>
            <h2 class="entry-title mt-2 text-capitalize">
              <div style= "color :#0975b8"><%= @tour.tour_title.html_safe%></div>
            </h2>
            <div class="entry-meta">
              <ul>
                <li>
                  <h6 class="font-weight-bold mt-2"><span><i class="icon fa fa-map"></i> <%= @tour.destination.city.html_safe%>, <%= @tour.destination.country.html_safe%></span></h6>
                </li>
                <li>
                  <h6 class="days mt-2"><span><i class="icon fa fa-calendar"></i>Tour Duration: <%= @tour.tour_duration.html_safe%></span></h6>
                </li>
              </ul>
              <div class="group-sm group-middle justify-content-start mt-2">
                <div class="product-big-rating"><span class="icon material-icons-star"></span></span><span class="icon material-icons-star"></span><span class="icon material-icons-star"></span><span class="icon material-icons-star_half"></span></div>
              <a class="product-big-reviews" ><p><%= Random.rand(50...100) %> customer reviews</p></a>
            </div>
          </div>
        </article>
        <%# <% end %>
      </div>
      <div class="col-lg-4 pl-5">
        <section id="course-details" class="course-details">
          <div class="" data-aos="fade-up">
            <div class="course-infot d-flex justify-content-between align-items-center">
              <h3 class="text-white">Recent Posts</h3>
            </div>
            <%@posts.each do |post|%>
              <div class="course-info d-flex justify-content-between align-items-center">
                <h6><%= link_to post.post_title,post_path(post)%></h6>
                <p><%= post.post_type %></p>
                <span><%= Date.parse(post.created_at.to_s).strftime('%A')%>,<%= Date.parse(post.created_at.to_s).to_formatted_s(:long)%></span>
              </div>
            <%end%>
          </div>
        </section>
      </div>
    </div>
  </div>
</section>
<!-- ======= On Focus Section ======= -->
<section id="onfocus" class="onfocus mt-3">
  <div class="container-fluid" data-aos="fade-up">
    <div class="row g-0">
      <div class="col-lg-6 p-0 ">
        <div class="content justify-content-center h-100">
          <section class="section section-sm section-first b-transparent text-md-left">
            <div class="">
              <div class="row row-50 align-items-center justify-content-center justify-content-xl-between">
                <div class="wow fadeInRight" data-wow-delay=".1s">
                  <div class="box-width-lg-470 d-flex flex-column">
                    <!-- Bootstrap tabs-->
                    <div class="tabs-custom tabs-horizontal tabs-line tabs-line-big tabs-line-style-2 text-center text-md-left" id="tabs-7">
                      <!-- Nav tabs-->
                      <ul class="nav nav-tabs">
                        <li class="nav-item" role="presentation"><a class="nav-link active" href="#tabs-7-1" data-toggle="tab">Tour Overview</a></li>
                        <li class="nav-item" role="presentation"><a class="nav-link" href="#tabs-7-2" data-toggle="tab">Itinerary</a></li>
                        <li class="nav-item" role="presentation"><a class="nav-link" href="#tabs-7-3" data-toggle="tab">Essential Info</a></li>
                      </ul>
                      <!-- Tab panes-->
                      <div class="tab-content">
                        <div class="tab-pane fade show active" id="tabs-7-1">
                          <p class="text-white"><%= @tour.desciption.html_safe %></p>
                          <div class="group-md group-middle"><a class="button button-secondary button-pipaluk" href="/contact">Book Tour</a></div>
                        </div>
                        <div class="tab-pane fade" id="tabs-7-2">
                          <p class="text-white"><%= @tour.itinerary.html_safe %></p>
                          <div class="group-md group-middle"><a class="button button-secondary button-pipaluk" href="/contact">Book Tour</a></div>
                        </div>
                        <div class="tab-pane fade" id="tabs-7-3">
                          <p class="text-white"><%= @tour.other_essential_info.html_safe %></p>
                          <div class="group-md group-middle"><a class="button button-secondary button-pipaluk" href="/contact">Book Tour</a></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
      <div class="col-lg-6 video-play position-relative" style="background-image: url(<%= rails_blob_url(@tour.medias[Random.rand(0...@tour.medias.length-1)])%>);">
        <a href="<%= @tour.tour_short_video %>" class="glightbox play-btn"><i class="bx bxl-linkedin"></i> </a>
      </div>
    </div>
  </div>
</section>
<!-- End On Focus Section -->
<div class="col-md-12 hotel-single mb-5 mt-4" >
  <h3 class="mb-4 ml-4">Tour Packages</h3>
  <div class="container">
    <div class="pricing py-5">
      <div class="mx-3">
        <div class="row">
          <!-- Free Tier -->
          <% @tour.packages.each do |package|%>
            <div class="col-lg-4 mb-3">
              <div class="card mb-5 mb-lg-0">
                <div class="card-body">
                  <h5 class="card-title text-muted text-uppercase text-center"><%= package.package_title%></h5>
                  <h6 class="card-price text-center"><%= number_to_currency package.price,format: "%u %n" ,delimiter: ",", precision: 0%></h6>
                  <hr>
                  <p><%= package.package_description.truncate(256).html_safe %></p>
                  <div class="d-flex">
                  <ul class="fa-ul mx-auto">
                    <% package.package_checklists.each do |package_checklist|%>
                      <li><span class="icon fa fa-li"><i class="fas fa-check"></i></span><%= package_checklist.list%></li>
                    <%end%>
                  </ul>
                  </div>
                  <button type="button" id="<%= package.id%>" onclick="passBtnID('<%= package.id%>')" class="btn btn-block btn-primary text-uppercase open-AddBookDialog" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Book Now</button>
                </div>
              </div>
            </div>
          <%end%>
        </div>
      </div>
    </div>
  </div>
</div>
<!------------------------->

<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Book Tour</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <%= form_for(Book.new, url: books_path, method: "post") do |f|%>
          <%= f.hidden_field 'package_id', id: 'package_id' %>
          <div class="form-group">
            <label for="full_name" class="col-form-label">Fullname</label>
            <%= f.text_field :customer_full_name, class: "form-control", placeholder: "Full Name *",required: true %>
          </div>
          <div class="form-group">
            <label for="email" class="col-form-label">Email</label>
            <%= f.email_field :email, class: "form-control", placeholder: "Email *",required: true %>
          </div>
          <div class="form-group">
            <label for="phone_number" class="col-form-label">Phone Number</label>
            <%= f.text_field :phone_number, class: "form-control", placeholder: "Phone Number *",required: true %>
          </div>
          <div class=
          "form-group">
            <label for="address" class="col-form-label">Adress</label>
            <%= f.text_field :address, class: "form-control", placeholder: "Address",required: true %>
          </div>
          <div class="form-group">
            <label for="quantity" class="col-form-label">Quantity</label>
            <%= f.number_field :quantity, class: "form-control", placeholder: "Quantity",required: true %>
          </div>
          <%= f.submit 'Book Now', class: "btn btn-primary py-3 px-5" %>
        <%end%>
      </div>
    </div>
  </div>
</div>
<script>
  function passBtnID(id) {
    var pid = id;
    $("#package_id").val(pid);
    $(".open-AddBookDialog").click(function(){
    $("#addBookDialog").modal("show");
    });
  }
</script>